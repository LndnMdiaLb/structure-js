<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<script type="text/javascript" src='structure.js'></script>
</head>
<body>

	<div class="a"></div>
	<div class="b"></div>
	<div class="c"></div>	
	<div class="d"></div>
	<div class="e"></div>
	<div class="f"></div>

	<script type="text/javascript">

		//////////////////////////////////////////////////////////////////////////////
		//	Collections
		//////////////////////////////////////////////////////////////////////////////

	window.a = new app.Map;
	// a.add('x','x');
	// a.add('x','y');
	// a.add('x','z');
	// a.add('x','o');
	// a.add('y','o');

	// a.add('addtimers','classA', '1');		
	// a.add('addtimers','classA', '2');	
	// a.add('addtimers','classA', '3');
	// a.add('addtimers','classA');

	// a.add('addtimers', 'temp', 'classA', '3');					

	// a.add('y',[{}, 'o2']);
	// a.remove('x','x');
	// a.remove('x','y');
	// a.remove('x','z');
	// a.remove('x','o');

	// console.log(a)
	// console.log(a instanceof app.Map)

	
	var s = new app.Set;
	s.add('x');
	s.add('x', 'y');
	s.add(['x', 'y']);

	//////////

		//////////////////////////////////////////////////////////////////////////////
		//	Dispatcher
		//////////////////////////////////////////////////////////////////////////////

	var b = new app.Dispatcher;
	var c = new app.Dispatcher(true);
	var d = {};

	b.augment(d);

	d.register('a',
		function(){
			console.log('d registered for a event using b')
		}) ;	

	b.register('a',
		function(){
			console.log('b registered for a event')
		}) ;

	c.register('a',
		function(){
			console.log('if only c is visible c a private dispatcher')
		}) ;	

	// c.emit('a');

	//////////

		//////////////////////////////////////////////////////////////////////////////
		//	Statemachine
		//////////////////////////////////////////////////////////////////////////////

	var Sequence = function(){
		var sm = new app.StateMachine;
		var d = new app.Dispatcher;
		// compostion
		sm.augment(this);
		d.augment(this);
	}	

	var sm = new Sequence;

	sm.register('x', 
		function(){
			console.log('Compostion via through methods works');
		})

	sm.addState('a', function(){
		console.log('state a')
		sm.setNextState('b') ;
		sm.changeState() ;
	})

	sm.addState('b', function(){
		console.log('state b') ;
		sm.goTo('c') ;
	})	

	sm.addState('c', function(){
		console.log('state c') ;
		sm.emit('x') ;
	})		

	sm.register('img-loaded', function(){
		console.log('global img-loaded caught')
	})

	// sm.goTo('a');

	//////////	



	function VO(){

		//////////////////////////////////////////////////////////////////////////////
		//	HTML to JS Structure
		//////////////////////////////////////////////////////////////////////////////

		var q = document.querySelector.bind( document );
		
		// is this a MODEL ?
		app.el={
			'a':q('.a'),
			'b':q('.b'),
			'c':q('.c'),					
			'd':q('.d'),
			'e':q('.e'),
			'f':q('.f')
		} ;

		app.vars = {
				fadeTime:1000,
				loops:2
				} ;		

	}	


	window.onload =function(){
		VO();

		//////////////////////////////////////////////////////////////////////////////
		//	Class Manipulation
		//////////////////////////////////////////////////////////////////////////////
		var u = app.utils ;

		u
			.addClass(app.el.a, 'x')
			.addClass(app.el.b, 'x')
			.addClass(app.el.c, 'x')
			.addClass(app.el.d, 'x')
			.addClass(app.el.e, 'x')
			.addClass(app.el.f, 'x')
			.addClass(app.el.f, 'y')
		;
		
		//////////////////////////////////////////////////////////////////////////////
		//	timed Class Manipulation
		//////////////////////////////////////////////////////////////////////////////

		u
			.addClass(app.el.f, 'z', 6000)
			.addClass(app.el.f, 'o', 6000)
		
			// .removeClass(app.el.f, 'z', 12000)
			// .removeClass(app.el.f, 'o', 18000)

			// kills removeClass
			// .removeClass.kill(app.el.f, 'o')
		
			// .reset(null, 25000) ;


		//////////////////////////////////////////////////////////////////////////////
		//	img loading
		//////////////////////////////////////////////////////////////////////////////

		window.iLoader = iLoader = new u.IMGLoader() ;
		iLoader.pause() ;

		// iLoader.load(
		// 	['img1.png', 'img2.png'],
		// 	function(e){
		// 		console.log(e.currentTarget.src, 'loaded')
		// 	} , 
		// 	'img-loaded' )

		// iLoader.load(
		// 	['img3.png', 'img4.png'],
		// 	function(e){
		// 		console.log(e.currentTarget.src, 'loaded')
		// 	} , 
		// 	'img-loaded' )

		// iLoader.start('img-loaded')

		// iLoader.load(
		// 	['img5.png'],
		// 	function(e){
		// 		console.log(e.currentTarget.src, 'loaded')
		// 	} , 
		// 	'img-loaded' )		

		

		//iLoader.start('img-loaded-2')

		iLoader.register('img-loaded', function(){
			console.log('private img-loaded caught') ;
		})

		setTimeout( function(){
			iLoader.start('img-loaded');
		}, 2000)		;
	}

	

	</script>
</body>
</html>